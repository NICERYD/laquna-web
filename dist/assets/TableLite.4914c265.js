import{bs as e,r as a,aw as t,c as l,bt as s,w as o,A as i,aF as n,_ as g,B as r,C as p,L as c,M as d,F as u,P as v,bu as h,aS as y,bv as k,J as f,K as m,bw as b,bx as C,by as w,N as x,O as S}from"./index.72a7fa6d.js";const R=e({name:"my-table",emits:["return-checked-rows","do-search","is-finished","get-now-page","row-clicked","row-toggled"],props:{isLoading:{type:Boolean,require:!0},isReSearch:{type:Boolean,require:!0},hasCheckbox:{type:Boolean,default:!1},checkedReturnType:{type:String,default:"key"},title:{type:String,default:""},isFixedFirstColumn:{type:Boolean,default:!1},columns:{type:Array,default:()=>[]},rows:{type:Array,default:()=>[]},rowClasses:{type:[Array,Function],default:()=>[]},pageSize:{type:Number,default:10},total:{type:Number,default:100},page:{type:Number,default:1},sortable:{type:Object,default:()=>({order:"id",sort:"asc"})},messages:{type:Object,default:()=>({pagingInfo:"Showing {0}-{1} of {2}",pageSizeChangeLabel:"Row count:",gotoPageLabel:"Go to page:",noDataAvailable:"No data"})},isStaticMode:{type:Boolean,default:!1},isSlotMode:{type:Boolean,default:!1},isHidePaging:{type:Boolean,default:!1},pageOptions:{type:Array,default:()=>[{value:10,text:10},{value:25,text:25},{value:50,text:50}]},groupingKey:{type:String,default:""},hasGroupToggle:{type:Boolean,default:!1},groupingDisplay:{type:Function,default:null},maxHeight:{default:"auto"},startCollapsed:{type:Boolean,default:!1},isKeepCollapsed:{type:Boolean,default:!1}},setup(e,{emit:g,slots:r}){let p=a(null),c=e.pageOptions.length>0?a(e.pageOptions[0].value):a(e.pageSize);e.pageOptions.length>0&&e.pageOptions.forEach((a=>{Object.prototype.hasOwnProperty.call(a,"value")&&Object.prototype.hasOwnProperty.call(a,"text")&&e.pageSize==a.value&&(c.value=a.value)}));const d=t({isSlotMode:e.isSlotMode,isCheckAll:!1,isHidePaging:e.isHidePaging,keyColumn:l((()=>{let a="";return Object.assign(e.columns).forEach((e=>{e.isKey&&(a=e.field)})),a})),page:e.page,pageSize:c.value,maxPage:l((()=>{if(e.total<=0)return 0;let a=Math.floor(e.total/d.pageSize);return e.total%d.pageSize>0&&a++,a})),offset:l((()=>(d.page-1)*d.pageSize+1)),limit:l((()=>{let a=d.page*d.pageSize;return e.total>=a?a:e.total})),paging:l((()=>{let e=d.page-2<=0?1:d.page-2;d.maxPage-d.page<=2&&(e=d.maxPage-4),e=e<=0?1:e;let a=[];for(let t=e;t<=d.maxPage;t++)a.length<5&&a.push(t);return a})),order:e.sortable.order,sort:e.sortable.sort,pageOptions:e.pageOptions}),u=a([]),v=l((()=>{let a=e.rows;var t=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});let l="desc"===d.sort?-1:1;a.sort((function(e,a){return t.compare(e[d.order],a[d.order])*l}));let s=null;if(e.groupingKey){let t={};a.forEach((a=>{t[a[e.groupingKey]]||(t[a[e.groupingKey]]=[]),t[a[e.groupingKey]].push(a)})),s={};for(let l=d.offset-1;l<d.limit;l++)s[a[l][e.groupingKey]]=t[a[l][e.groupingKey]]}else{s=[];for(let e=d.offset-1;e<d.limit;e++)s.push(a[e])}return n((function(){f()})),s})),h=a([]);s((()=>{h.value=[]})),o((()=>d.isCheckAll),(a=>{if(e.hasCheckbox){if(u.value=[],a){let a=e.isStaticMode?e.rows.slice(d.offset-1,d.limit):e.rows;"row"==e.checkedReturnType?u.value=a:a.forEach((e=>{u.value.push(e[d.keyColumn])}))}h.value.forEach((e=>{e&&(e.checked=a)})),g("return-checked-rows",u.value)}})),o((()=>e.hasCheckbox),(e=>{e||(d.isCheckAll=!1)}));const y=()=>{u.value=[],h.value.forEach((e=>{e&&e.checked&&(e.checked=!1)})),g("return-checked-rows",u.value)},k=(a,t)=>{d.isCheckAll=!1,e.hasCheckbox&&(u.value=[]);let l=d.order,s=d.sort,o=(a-1)*d.pageSize,i=d.pageSize;(!e.isReSearch||a>1||a==t)&&g("do-search",o,i,l,s)};o((()=>d.page),k),o((()=>e.page),(e=>{e<=1?(d.page=1,g("get-now-page",d.page)):e>=d.maxPage?(d.page=d.maxPage,g("get-now-page",d.page)):d.page=e}));o((()=>d.pageSize),(()=>{1===d.page?k(d.page,d.page):(d.page=1,d.isCheckAll=!1)})),o((()=>e.pageSize),(e=>{d.pageSize=e}));o((()=>e.rows),(()=>{(e.isReSearch||e.isStaticMode)&&(d.page=1),n((function(){e.isStaticMode||f()}))}));const f=()=>{if(p.value){let e=p.value.getElementsByClassName("is-rows-el");g("is-finished",e)}g("get-now-page",d.page)},m=a({}),b=a({}),C=a({}),w=l((()=>{let a={};return e.rows.forEach((t=>{a[t[e.groupingKey]]||(a[t[e.groupingKey]]=[]),a[t[e.groupingKey]].push(t)})),n((function(){if(e.startCollapsed||e.isKeepCollapsed)for(const[a,t]of Object.entries(m.value))if(t){let l=!e.startCollapsed;e.isKeepCollapsed&&void 0!==C.value[a]&&(l=!C.value[a]),(l&&t.parentElement.classList.contains("rotated-90")||!l&&!t.parentElement.classList.contains("rotated-90"))&&t.parentElement.classList.toggle("rotated-90"),l||b.value[a].forEach((e=>{e&&e.classList.add("hidden")}))}f()})),a}));return i((()=>{n((()=>{e.rows.length>0&&f()}))})),{slots:r,localTable:p,localRows:v,setting:d,rowCheckbox:h,checked:(a,t)=>{t.stopPropagation();let l=a[d.keyColumn];if("row"==e.checkedReturnType&&(l=a),t.target.checked)u.value.push(l);else{const e=u.value.indexOf(l);e>=0&&u.value.splice(e,1)}u.value.length==e.rows.length?d.isCheckAll=!0:g("return-checked-rows",u.value)},clearChecked:y,doSort:a=>{let t="asc";a==d.order&&"asc"==d.sort&&(t="desc");let l=(d.page-1)*d.pageSize,s=d.pageSize;d.order=a,d.sort=t,g("do-search",l,s,a,t),d.isCheckAll?d.isCheckAll=!1:e.hasCheckbox&&y()},prevPage:()=>{if(1==d.page)return!1;d.page--},movePage:e=>{d.page=e},nextPage:()=>{if(d.page>=d.maxPage)return!1;d.page++},stringFormat:(e,...a)=>e.replace(/{(\d+)}/g,(function(e,t){return void 0!==a[t]?a[t]:e})),toggleButtonRefs:m,groupingRowsRefs:b,groupingRows:w,toggleGroup:e=>{let a=m.value[e];if(a){a.parentElement.classList.toggle("rotated-90");const t=a.parentElement.classList.contains("rotated-90");b.value[e].forEach((e=>{e&&(t?e.classList.add("hidden"):e.classList.remove("hidden"))})),C.value[e]=t,g("row-toggled",w.value[e],t)}},addHoverClassToTr:e=>{e.target.classList.add("hover")},removeHoverClassFromTr:e=>{e.target.classList.remove("hover")}}}}),T=e=>(x("data-v-8083b084"),e=e(),S(),e),P={class:"vtl vtl-card"},L={key:0,class:"vtl-card-title"},H={class:"vtl-card-body"},M={class:"vtl-row"},z={key:0,class:"vtl-loading-mask"},K=[T((()=>u("div",{class:"vtl-loading-content"},[u("span",{style:{color:"white"}},"Loading...")],-1)))],O={class:"vtl-thead"},F={class:"vtl-thead-tr"},A={key:0,class:"vtl-thead-th vtl-checkbox-th"},B=["onClick"],E=["set"],_={key:0,class:"vtl-tbody-tr vtl-group-tr"},N=["colspan"],j={class:"flex"},D={key:0,class:"animation"},G=["onClick"],I=["innerHTML"],$=["name","onClick"],U={key:0,class:"vtl-tbody-td vtl-checkbox-td"},V=["value","onClick"],q=["innerHTML"],J={key:1},Q={key:0},W={key:1},X=["set"],Y={key:0,class:"vtl-tbody-tr vtl-group-tr"},Z=["colspan"],ee={class:"flex"},ae={key:0,class:"animation"},te=["onClick"],le=["innerHTML"],se=["name","onClick"],oe={key:0,class:"vtl-tbody-td vtl-checkbox-td"},ie=["value","onClick"],ne=["innerHTML"],ge={key:1},re={key:0},pe={key:1},ce={key:0,class:"vtl-paging vtl-row"},de={class:"vtl-paging-info col-sm-12 col-md-4"},ue={role:"status","aria-live":"polite"},ve={class:"vtl-paging-change-div col-sm-12 col-md-4"},he={class:"vtl-paging-count-label"},ye=["value"],ke={class:"vtl-paging-page-label"},fe=["value"],me={class:"vtl-paging-pagination-div col-sm-12 col-md-4"},be={class:"dataTables_paginate"},Ce={class:"vtl-paging-pagination-ul vtl-pagination"},we=[T((()=>u("span",{"aria-hidden":"true"},"«",-1))),T((()=>u("span",{class:"sr-only"},"First",-1)))],xe=[T((()=>u("span",{"aria-hidden":"true"},"<",-1))),T((()=>u("span",{class:"sr-only"},"Prev",-1)))],Se=["onClick"],Re=[T((()=>u("span",{"aria-hidden":"true"},">",-1))),T((()=>u("span",{class:"sr-only"},"Next",-1)))],Te=[T((()=>u("span",{"aria-hidden":"true"},"»",-1))),T((()=>u("span",{class:"sr-only"},"Last",-1)))],Pe={key:1,class:"vtl-row"},Le={class:"vtl-empty-msg col-sm-12 text-center"};const He=g(R,[["render",function(e,a,t,l,s,o){return r(),p("div",P,[e.title?(r(),p("div",L,c(e.title),1)):d("",!0),u("div",H,[u("div",M,[u("div",{class:v(["col-sm-12",{"fixed-first-column":e.isFixedFirstColumn,"fixed-first-second-column":e.isFixedFirstColumn&&e.hasCheckbox}])},[e.isLoading?(r(),p("div",z,K)):d("",!0),u("table",{class:"vtl-table vtl-table-hover vtl-table-bordered vtl-table-responsive vtl-table-responsive-sm",ref:"localTable",style:h("max-height: "+e.maxHeight+"px;")},[u("thead",O,[u("tr",F,[e.hasCheckbox?(r(),p("th",A,[u("div",null,[y(u("input",{type:"checkbox",class:"vtl-thead-checkbox","onUpdate:modelValue":a[0]||(a[0]=a=>e.setting.isCheckAll=a)},null,512),[[k,e.setting.isCheckAll]])])])):d("",!0),(r(!0),p(f,null,m(e.columns,((a,t)=>(r(),p("th",{class:v(["vtl-thead-th",a.headerClasses]),key:t,style:h(Object.assign({width:a.width?a.width:"auto"},a.headerStyles))},[u("div",{class:v(["vtl-thead-column",{"vtl-sortable":a.sortable,"vtl-both":a.sortable,"vtl-asc":e.setting.order===a.field&&"asc"===e.setting.sort,"vtl-desc":e.setting.order===a.field&&"desc"===e.setting.sort}]),onClick:b((t=>!!a.sortable&&e.doSort(a.field)),["prevent"])},c(a.label),11,B)],6)))),128))])]),e.rows.length>0?(r(),p(f,{key:0},[e.isStaticMode?(r(),p("tbody",{key:0,class:"vtl-tbody",set:e.templateRows=""==e.groupingKey?[e.localRows]:e.localRows},[(r(!0),p(f,null,m(e.templateRows,((t,l)=>(r(),p(f,{key:l},[""!=e.groupingKey?(r(),p("tr",_,[u("td",{colspan:e.hasCheckbox?e.columns.length+1:e.columns.length,class:"vtl-tbody-td vtl-group-td"},[u("div",j,[e.hasGroupToggle?(r(),p("div",D,[u("a",{ref_for:!0,ref:a=>e.toggleButtonRefs[l]=a,class:"cursor-pointer",onClick:b((a=>e.toggleGroup(l)),["prevent"])},"▼",8,G)])):d("",!0),u("div",{class:"ml-2",innerHTML:e.groupingDisplay?e.groupingDisplay(l):l},null,8,I)])],8,N)])):d("",!0),(r(!0),p(f,null,m(t,((t,s)=>(r(),p("tr",{key:t[e.setting.keyColumn]?t[e.setting.keyColumn]:s,ref_for:!0,ref:a=>{e.groupingRowsRefs[l]||(e.groupingRowsRefs[l]=[]),e.groupingRowsRefs[l][s]=a},name:"vtl-group-"+l,class:v(["vtl-tbody-tr","function"==typeof e.rowClasses?e.rowClasses(t):e.rowClasses]),onMouseenter:a[1]||(a[1]=(...a)=>e.addHoverClassToTr&&e.addHoverClassToTr(...a)),onMouseleave:a[2]||(a[2]=(...a)=>e.removeHoverClassFromTr&&e.removeHoverClassFromTr(...a)),onClick:a=>e.$emit("row-clicked",t)},[e.hasCheckbox?(r(),p("td",U,[u("div",null,[u("input",{type:"checkbox",class:"vtl-tbody-checkbox",ref_for:!0,ref:a=>{e.rowCheckbox.push(a)},value:t[e.setting.keyColumn],onClick:a=>e.checked(t,a)},null,8,V)])])):d("",!0),(r(!0),p(f,null,m(e.columns,((a,l)=>(r(),p("td",{key:l,class:v(["vtl-tbody-td",a.columnClasses]),style:h(a.columnStyles)},[a.display?(r(),p("div",{key:0,innerHTML:a.display(t)},null,8,q)):(r(),p("div",J,[e.setting.isSlotMode&&e.slots[a.field]?(r(),p("div",Q,[C(e.$slots,a.field,{value:t},void 0,!0)])):(r(),p("span",W,c(t[a.field]),1))]))],6)))),128))],42,$)))),128))],64)))),128))],8,E)):(r(),p("tbody",{key:1,set:e.templateRows=""==e.groupingKey?[e.rows]:e.groupingRows},[(r(!0),p(f,null,m(e.templateRows,((t,l)=>(r(),p(f,{key:l},[""!=e.groupingKey?(r(),p("tr",Y,[u("td",{colspan:e.hasCheckbox?e.columns.length+1:e.columns.length,class:"vtl-tbody-td vtl-group-td"},[u("div",ee,[e.hasGroupToggle?(r(),p("div",ae,[u("a",{ref_for:!0,ref:a=>e.toggleButtonRefs[l]=a,class:"cursor-pointer",onClick:b((a=>e.toggleGroup(l)),["prevent"])},"▼",8,te)])):d("",!0),u("div",{class:"ml-2",innerHTML:e.groupingDisplay?e.groupingDisplay(l):l},null,8,le)])],8,Z)])):d("",!0),(r(!0),p(f,null,m(t,((t,s)=>(r(),p("tr",{ref_for:!0,ref:a=>{e.groupingRowsRefs[l]||(e.groupingRowsRefs[l]=[]),e.groupingRowsRefs[l][s]=a},name:"vtl-group-"+l,key:t[e.setting.keyColumn]?t[e.setting.keyColumn]:s,class:v(["vtl-tbody-tr","function"==typeof e.rowClasses?e.rowClasses(t):e.rowClasses]),onMouseenter:a[3]||(a[3]=(...a)=>e.addHoverClassToTr&&e.addHoverClassToTr(...a)),onMouseleave:a[4]||(a[4]=(...a)=>e.removeHoverClassFromTr&&e.removeHoverClassFromTr(...a)),onClick:a=>e.$emit("row-clicked",t)},[e.hasCheckbox?(r(),p("td",oe,[u("div",null,[u("input",{type:"checkbox",class:"vtl-tbody-checkbox",ref_for:!0,ref:a=>{e.rowCheckbox.push(a)},value:t[e.setting.keyColumn],onClick:a=>e.checked(t,a)},null,8,ie)])])):d("",!0),(r(!0),p(f,null,m(e.columns,((a,l)=>(r(),p("td",{key:l,class:v(["vtl-tbody-td",a.columnClasses]),style:h(a.columnStyles)},[a.display?(r(),p("div",{key:0,innerHTML:a.display(t)},null,8,ne)):(r(),p("div",ge,[e.setting.isSlotMode&&e.slots[a.field]?(r(),p("div",re,[C(e.$slots,a.field,{value:t},void 0,!0)])):(r(),p("span",pe,c(t[a.field]),1))]))],6)))),128))],42,se)))),128))],64)))),128))],8,X))],64)):d("",!0)],4)],2)]),e.rows.length>0?(r(),p("div",ce,[e.setting.isHidePaging?d("",!0):(r(),p(f,{key:0},[u("div",de,[u("div",ue,c(e.stringFormat(e.messages.pagingInfo,e.setting.offset,e.setting.limit,e.total)),1)]),u("div",ve,[u("span",he,c(e.messages.pageSizeChangeLabel),1),y(u("select",{class:"vtl-paging-count-dropdown","onUpdate:modelValue":a[5]||(a[5]=a=>e.setting.pageSize=a)},[(r(!0),p(f,null,m(e.pageOptions,(e=>(r(),p("option",{value:e.value,key:e.value},c(e.text),9,ye)))),128))],512),[[w,e.setting.pageSize]]),u("span",ke,c(e.messages.gotoPageLabel),1),y(u("select",{class:"vtl-paging-page-dropdown","onUpdate:modelValue":a[6]||(a[6]=a=>e.setting.page=a)},[(r(!0),p(f,null,m(e.setting.maxPage,(e=>(r(),p("option",{key:e,value:parseInt(e)},c(e),9,fe)))),128))],512),[[w,e.setting.page]])]),u("div",me,[u("div",be,[u("ul",Ce,[u("li",{class:v(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-first page-item",{disabled:e.setting.page<=1}])},[u("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-first page-link cursor-pointer","aria-label":"Previous",onClick:a[7]||(a[7]=b((a=>e.setting.page=1),["prevent"]))},we)],2),u("li",{class:v(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-prev page-item",{disabled:e.setting.page<=1}])},[u("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-prev page-link cursor-pointer","aria-label":"Previous",onClick:a[8]||(a[8]=b(((...a)=>e.prevPage&&e.prevPage(...a)),["prevent"]))},xe)],2),(r(!0),p(f,null,m(e.setting.paging,(a=>(r(),p("li",{class:v(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-number page-item",{disabled:e.setting.page===a}]),key:a},[u("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-number page-link cursor-pointer",onClick:b((t=>e.movePage(a)),["prevent"])},c(a),9,Se)],2)))),128)),u("li",{class:v(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-next page-item",{disabled:e.setting.page>=e.setting.maxPage}])},[u("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-next page-link cursor-pointer","aria-label":"Next",onClick:a[9]||(a[9]=b(((...a)=>e.nextPage&&e.nextPage(...a)),["prevent"]))},Re)],2),u("li",{class:v(["vtl-paging-pagination-page-li vtl-paging-pagination-page-li-last page-item",{disabled:e.setting.page>=e.setting.maxPage}])},[u("a",{class:"vtl-paging-pagination-page-link vtl-paging-pagination-page-link-last page-link cursor-pointer","aria-label":"Next",onClick:a[10]||(a[10]=b((a=>e.setting.page=e.setting.maxPage),["prevent"]))},Te)],2)])])])],64))])):(r(),p("div",Pe,[u("div",Le,c(e.messages.noDataAvailable),1)]))])])}],["__scopeId","data-v-8083b084"]]);export{He as T};
